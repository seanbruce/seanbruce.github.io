{"data":{"site":{"siteMetadata":{"title":"鹊巢小筑","author":"Sean"}},"markdownRemark":{"id":"54be2420-2554-53f8-bdd4-4b24fd0398e6","excerpt":"如果你不清楚如何判断 JS 函数中 this 的值是什么，也许你可以花些时间阅读一下这一篇博客。 最后两行代码输出的结果是多少？ 回答刚才的问题前，不得不简单提一下另外一个同样重要，同样让 JS…","html":"<p>如果你不清楚如何判断 JS 函数中 this 的值是什么，也许你可以花些时间阅读一下这一篇博客。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'tom'</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'jim'</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">let</span> bar <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Bob'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">whoAmI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nbar<span class=\"token punctuation\">.</span><span class=\"token function\">whoAmI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>最后两行代码输出的结果是多少？</p>\n<p>回答刚才的问题前，不得不简单提一下另外一个同样重要，同样让 JS 新手困惑的知识点，<strong>闭包</strong>，因为对闭包的判断常常和对 <code class=\"language-text\">this</code>值的判断弄混淆。</p>\n<p>闭包和<code class=\"language-text\">this</code>判断最大的不同就是，<strong>闭包是在代码编写时就确定的，而 this 值的判定则是当函数调用的时候才能确定，这一点非常重要</strong>, 举个例子：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> names <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'jim'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Bob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Amy'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">const</span> funcs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">funcGenerator</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token function\">generatedFunc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"I'm \"</span> <span class=\"token operator\">+</span> name<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>name <span class=\"token keyword\">of</span> names<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  funcs<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token function\">funcGenerator</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>func <span class=\"token keyword\">of</span> funcs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 输出结果</span>\n<span class=\"token comment\">// I'm jim</span>\n<span class=\"token comment\">// I'm Bob</span>\n<span class=\"token comment\">// I'm Amy</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>第 9 行的循环里，<code class=\"language-text\">funcGenerator</code>被调用了三次，分别传入<code class=\"language-text\">jim</code> <code class=\"language-text\">Bob</code> <code class=\"language-text\">Amy</code>。返回的新函数存入<code class=\"language-text\">funcs</code>数组内。注意到到循环结束，生成的函数并没有被调用，而是被保存到了函数定义时的作用域<em>(funcGenerator 内部)</em>之外的地方。当这三个函数在第 14 行被调用的时候，已经和<code class=\"language-text\">funcGenerator</code>的<code class=\"language-text\">name</code>参数不在同一个作用域中，但是每个函数定义内对<code class=\"language-text\">name</code>的引用，任然可以访问<code class=\"language-text\">name</code>参数的值</p>","frontmatter":{"title":"JavaScript函数中的this指的到底是什么？","date":" 2019年 一月 30"}}},"pageContext":{"slug":"/what-is-this/","previous":{"fields":{"slug":"/hello-world/"},"frontmatter":{"title":"第一篇博客"}},"next":null}}